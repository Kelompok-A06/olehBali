{% extends 'base.html' %}

{% block meta %}
<title>Login/Signup</title>
{% endblock meta %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-base-200">
    <div class="card w-full max-w-md shadow-xl bg-base-100">
        <!-- Login Form -->
        <div id="login-form">
            <div class="card-body">
                <h2 class="card-title justify-center">Login</h2>

                <div class="tabs tabs-boxed mb-4 justify-center">
                    <button class="tab tab-active" onclick="showLogin()">Login</button>
                    <button class="tab" onclick="showSignup()">Signup</button>
                </div>

                <form method="POST" action="" class="space-y-4">
                    {% csrf_token %}
                    <div class="form-control">
                        <input type="text" name="username" placeholder="Username" required class="input input-bordered w-full">
                        {% if login_form.username.errors %}
                            <div class="text-error">{{ login_form.username.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <div class="form-control">
                        <input type="password" name="password" placeholder="Password" required class="input input-bordered w-full">
                        {% if login_form.password.errors %}
                            <div class="text-error">{{ login_form.password.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <button type="submit" class="btn btn-primary w-full" name="login">Login</button>
                    <div class="text-center mt-4">
                        <p>Not a member? <a href="#" class="link link-primary" onclick="showSignup()">Signup now!</a></p>
                    </div>
                </form>
            </div>
        </div>

        <!-- Signup Form -->
        <div id="signup-form" class="hidden">
            <div class="card-body">
                <h2 class="card-title justify-center">Signup</h2>

                <div class="tabs tabs-boxed mb-4 justify-center">
                    <button class="tab" onclick="showLogin()">Login</button>
                    <button class="tab tab-active" onclick="showSignup()">Signup</button>
                </div>

                <form method="POST" action="" class="space-y-4">
                    {% csrf_token %}
                    <div class="form-control">
                        <input type="text" name="username" placeholder="Username" required class="input input-bordered w-full">
                        {% if register_form.username.errors %}
                            <div class="text-error">{{ register_form.username.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <div class="form-control">
                        <input type="password" name="password1" placeholder="Password" required class="input input-bordered w-full">
                        {% if register_form.password1.errors %}
                            <div class="text-error">{{ register_form.password1.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <div class="form-control">
                        <input type="password" name="password2" placeholder="Confirm password" required class="input input-bordered w-full">
                        {% if register_form.password2.errors %}
                            <div class="text-error">{{ register_form.password2.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <div class="form-control">
                        <select name="role" required class="select select-bordered w-full">
                            <option value="" disabled selected>Role</option>
                            <option value="user">User</option>
                            <option value="owner">Owner</option>
                        </select>
                        {% if register_form.role.errors %}
                            <div class="text-error">{{ register_form.role.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <button type="submit" class="btn btn-primary w-full" name="register">Signup</button>
                </form>
            </div>
        </div>

        <!-- Success Message -->
        {% if messages %}
            <div class="text-center my-4">
                {% for message in messages %}
                    {% if message.tags == 'success' %}
                        <div class="text-success">{{ message }}</div>
                    {% endif %}
                {% endfor %}
            </div>
        {% endif %}
    </div>
</div>

<script>
function showLogin() {
    document.getElementById('login-form').classList.remove('hidden');
    document.getElementById('signup-form').classList.add('hidden');
}

function showSignup() {
    document.getElementById('login-form').classList.add('hidden');
    document.getElementById('signup-form').classList.remove('hidden');
}
</script>
{% endblock content %}
