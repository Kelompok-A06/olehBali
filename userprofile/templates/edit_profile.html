{% extends 'base.html' %}
{% load static %}

{% block meta %}
<style>
  body {
    background: linear-gradient(45deg, #FE9642, #ffbe98);
    min-height: 100vh;
  }

  .menu .active {
    background-color: #03A4C1 !important;
    color: white !important;
  }

  .custom-shadow {
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  }

  .input {
    color: #000; /* Pastikan teks hitam untuk kontras */
  }

  /* Popup Styles */
  .popup {
    display: none; /* Sembunyikan popup secara default */
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5); /* Latar belakang transparan */
    z-index: 1000; /* Pastikan popup muncul di atas konten lain */
  }

  .popup-content {
    background-color: white;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%; /* Lebar popup */
    max-width: 500px; /* Lebar maksimum popup */
    border-radius: 10px; /* Sudut membulat */
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  }

  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }

  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }
</style>
{% endblock meta %}

{% block content %}
{% include 'navbar.html' %}

<div class="container mx-auto p-4 min-h-screen">
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
    <!-- Sidebar -->
    <div class="bg-white rounded-2xl custom-shadow p-6">
      <h3 class="text-xl font-bold mb-4 text-gray-800">My Account</h3>
      <ul class="menu bg-base-200 rounded-xl">
        <li><a href="{% url 'userprofile:dashboard' user.pk %}" class="mb-2 hover:bg-[#03A4C1] hover:text-white">Account Information</a></li>
        {% if show_wishlist %}
          <li><a href="{% url 'userprofile:wishlist_dashboard' %}" class="hover:bg-[#03A4C1] hover:text-white">My Wishlist</a></li>
        {% endif %}
      </ul>
      <form method="POST" action="{% url 'userprofile:delete_account' %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-error w-full mt-6 text-white">Delete Account</button>
      </form>
    </div>

    <!-- Main Content -->
    <div class="md:col-span-3 bg-white rounded-2xl custom-shadow p-6">
      <h2 class="text-2xl font-bold mb-6 text-gray-800">Account Information</h2>
      <button onclick="openPopup()" class="btn bg-[#03A4C1] hover:bg-[#028091] text-white">Edit Profile</button>

      <!-- Popup for Editing Profile -->
      <div id="editProfilePopup" class="popup">
        <div class="popup-content">
          <span class="close" onclick="closePopup()">&times;</span>
          <h2 class="text-2xl font-bold mb-4">Edit Profile</h2>
          <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="form-control">
                <label class="label">
                  <span class="label-text font-bold">Name*</span>
                </label>
                <input type="text" name="name" value="{{ profile.name }}" class="input input-bordered focus:border-[#03A4C1]" required />
              </div>

              <div class="form-control">
                <label class="label">
                  <span class="label-text font-bold">Phone Number*</span>
                </label>
                <input type="tel" name="phone_number" value="{{ profile.phone_number }}" class="input input-bordered focus:border-[#03A4C1]" required />
              </div>

              <div class="form-control">
                <label class="label">
                  <span class="label-text font-bold">Email*</span>
                </label>
                <input type="email" name="email" value="{{ profile.email }}" class="input input-bordered focus:border-[#03A4C1]" required />
              </div>

              <div class="form-control">
                <label class="label">
                  <span class="label-text font-bold">Birthdate*</span>
                </label>
                <input type="date" name="birthdate" value="{{ profile.birthdate|date:'Y-m-d' }}" class="input input-bordered focus:border-[#03A4C1]" required />
              </div>
            </div>

            <div class="mt-6 flex justify-end">
              <button type="submit" class="btn bg-[#03A4C1] hover:bg-[#028091] text-white border-none">Save Changes</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function openPopup() {
    document.getElementById("editProfilePopup").style.display = "block";
  }

  function closePopup() {
    document.getElementById("editProfilePopup").style.display = "none";
  }

  // Tutup popup jika pengguna mengklik di luar konten popup
  window.onclick = function(event) {
    var popup = document.getElementById("editProfilePopup");
    if (event.target == popup) {
      popup.style.display = "none";
    }
  }
</script>
{% endblock content %}
